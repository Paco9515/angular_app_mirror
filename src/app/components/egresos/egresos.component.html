<div class="container-fluid p-3">
    <div class="animated fadeIn">
        <div class="row justify-content-center">
            <form class="col-12">

                <div class="col-md-12">
                    <div class="card shadow">
                        <div class="card-header">
                            <div class="row">
                                <div class="col-12 col-md-8 text-center text-sm-left  h5 font-weight-bold">
                                    Clasificación programática.
                                </div>
                            </div>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-6">
                                    <div class="col-sm-12">
                                        <label>
										Programa
									</label>
                                        <select class="form-control" name="programa" (change)="getSubprogramasByPrograma($event.target.value)" required>
                                            <option value=''>
                                                Seleccione un programa
                                            </option>
                                            <option *ngFor="let programa of programas" [value]="programa.id">
                                                {{ programa.id}} - {{ programa.nombre }}
                                            </option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-6">
                                    <div class="col-sm-12">
                                        <label>
										Subprograma
									</label>
                                        <select class="form-control" name="id_subprograma" [(ngModel)]="id_subprograma" required>
                                            <option value=''>
                                                Seleccione un programa
                                            </option>
                                            <option *ngFor="let subprograma of subprogramas" [value]="subprograma.id">
                                                {{ subprograma.codigo }} - {{ subprograma.nombre }}
                                            </option>
									    </select>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-12">
                    <div class="card shadow">
                        <div class="card-header">
                            <div class="row">
                                <div class="col-12 col-md-8 text-center text-sm-left  h5 font-weight-bold">
                                    Proyectos y fases.
                                </div>
                            </div>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-6">
                                    <div class="col-sm-12">
                                        <label>
										Proyecto
									</label>
                                        <select class="form-control" name="proyecto" (change)="getFasesByProyecto($event.target.value)" required>
                                            <option value=''>
                                                Seleccione un proyecto
                                            </option>
                                            <option *ngFor="let proyecto of proyectos" [value]="proyecto.id">
                                                {{ proyecto.codigo }} - {{ proyecto.nombre }}
                                            </option>
                                    </select>
                                    </div>
                                </div>
                                <div class="col-6">
                                    <div class="col-sm-12">
                                        <label>
										Fase
									</label>
                                        <select class="form-control" name="id_fase" [(ngModel)]="id_fase" required>
                                            <option value="">
                                                Seleccione un fase
                                            </option>
                                            <option *ngFor="let fase of fases" [value]="fase.id">
                                                {{ fase.codigo }} - {{ fase.nombre }}
                                            </option>
                                    </select>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="col-md-12">
                    <div class="card shadow">
                        <div class="card-header">
                            <div class="row">
                                <div class="col-12 col-md-8 text-center text-sm-left h5 font-weight-bold">
                                    Clasificación por fuente de financiamiento.
                                </div>
                            </div>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-12">
                                    <app-cff class="col-6" [primary_keys_cff]="cff_keys" (out)="getDataCFF($event)"></app-cff>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="col-md-12">
                    <div class="card shadow">
                        <div class="card-header">
                            <div class="row">
                                <div class="col-12 col-md-8 text-center text-sm-left  h5 font-weight-bold">
                                    Clasificación administrativa.
                                </div>
                            </div>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-12">
                                    <app-ui [primary_keys_ui]="ui_keys" (out)="getDataUI($event)"></app-ui>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="col-md-12">
                    <div class="card shadow">
                        <div class="card-header">
                            <div class="row">
                                <div class="col-12 col-md-8 text-center text-sm-left  h5 font-weight-bold">
                                    Clasificación por objeto de gasto.
                                </div>
                            </div>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-12">
                                    <app-cog [primary_keys_cog]="cog_keys" (out)="getDataCOG($event)"></app-cog>
                                    <div class="row">
                                        <div class="col-6 mt-2">
                                            <label for="cantidad">
                                            Cantidad
                                        </label>
                                            <input class="form-control" name="cantidad" type="number" placeholder="Ingresa la cantidad" minlength="0" [(ngModel)]="cantidad" required>
                                        </div>
                                    </div>

                                    <div class="row">
                                        <div class="col-6">
                                            <button class="btn btn-success mt-2" (click)="agregarPartida()" [disabled]="cog_data.id_partida===''">
											Agregar partida
										</button>
                                        </div>
                                    </div>

                                    <div class="table-responsive mt-3">
                                        <table class="table table-striped">
                                            <thead class="thead-dark">
                                                <tr>
                                                    <th scope="col">#</th>
                                                    <th scope="col">Centro costo</th>
                                                    <th scope="col">Cod. Partida</th>
                                                    <th scope="col">Nombre partida</th>
                                                    <th scope="col">Importe</th>
                                                    <th class="text-center" scope="col">Eliminar</th>
                                                </tr>
                                            </thead>
                                            <tbody *ngIf="partidas.length>0; else tableEmpty">
                                                <tr *ngFor="let item of partidas; let i = index">
                                                    <td>{{ i+1 }}</td>
                                                    <td>{{ item.nombre_cc }}</td>
                                                    <td>{{ item.codigo_partida }}</td>
                                                    <td>{{ item.nombre_partida }}</td>
                                                    <td>{{ item.importe }}</td>
                                                    <td>
                                                        <button type="button" class="btn btn-danger btn-sm w-auto mb-1 ml-1" (click)="eliminarPartida(i,item.importe)">
														<i class="fas fa-trash"></i>
														Eliminar
													</button>
                                                    </td>
                                                </tr>
                                            </tbody>
                                            <ng-template #tableEmpty>
                                                <tbody>
                                                    <td colspan="6" class="text-center">
                                                        No hay datos que mostrar.
                                                    </td>
                                                </tbody>
                                            </ng-template>
                                            <tfoot class="">
                                                <tr>
                                                    <td colspan="4" class="text-right">
                                                        Total
                                                    </td>
                                                    <td colspan="2" class="text-left">
                                                        ${{ total }}
                                                    </td>
                                                </tr>
                                            </tfoot>
                                        </table>
                                    </div>
                                    <div class="row">
                                        <div class="col-6 text-right">
                                            <button class="btn btn-primary" (click)="savePartidasCC()">
											Guardar centro de costo con sus partidas
										</button>
                                        </div>
                                        <div class="col-6 text-left">
                                            <button class="btn btn-info" data-toggle="modal" data-target="#centros_partidas" (click)="mostrarPartidas()">
											Ver centros de costo con sus partidas
										</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-12">
                    <button class="btn btn-success mb-3 btn-block" type="submit" (click)="guardarInfo()">
                        Guardar presupuesto de egreso
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

<div class="modal fade" id="centros_partidas" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal_class_info" role="document">
        <div class="modal-content ">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">
                    Centros de costo con sus partidas
                </h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col-12">
                        <div class="form-group row">
                            <div class="table-responsive">
                                <table class="table table-striped table-sm">
                                    <thead class="thead-dark">
                                        <tr>
                                            <th scope="col">#</th>
                                            <th scope="col">Centro de Costo</th>
                                            <th scope="col">Codigo Partida</th>
                                            <th scope="col">Nombre Partida</th>
                                            <th scope="col">Importe</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr *ngIf="info.length==0">
                                            <td colspan="5" class="text-center">
                                                <span class="badge badge-info">
                                                    <h5>
                                                        <i class="far fa-frown"></i>
                                                        No hay elementos para mostrar.
                                                    </h5>
                                                </span>
                                            </td>
                                        </tr>
                                        <tr *ngFor="let item of info; let i = index">
                                            <td>{{ i+1 }}</td>
                                            <td>{{ item.nombre_cc }}</td>
                                            <td>{{ item.codigo_partida }}</td>
                                            <td>{{ item.nombre_partida }}</td>
                                            <td>$ {{ item.importe }}</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">
                    Cerrar
                </button>
            </div>
        </div>
    </div>
</div>